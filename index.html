<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROSIE - Recruitment Master Toolkit 2026</title>
    
    <!-- Fonts: Inter (Modern UI) & Oswald (Headers) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Oswald:wght@400;500;600&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- PPTX Generator -->
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 
                            primary: '#0F172A',   // Slate 900 (Sidebar)
                            accent: '#F59E0B',    // Amber 500 (Highlights)
                            teal: '#0D9488',      // Teal 600 (Action - Darker for better contrast)
                            blue: '#2563EB',      // Blue 600 (Info)
                            red: '#DC2626',       // Red 600 (Alert)
                            bg: '#F8FAFC',        // Slate 50 (App Background)
                            surface: '#FFFFFF',   // White (Cards)
                            border: '#E2E8F0'     // Slate 200 (Borders)
                        },
                        fontFamily: { 
                            sans: ['Inter', 'sans-serif'], 
                            header: ['Oswald', 'sans-serif'],
                            mono: ['JetBrains Mono', 'monospace']
                        },
                        boxShadow: {
                            'soft': '0 4px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px -1px rgba(0, 0, 0, 0.02)',
                            'hover': '0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.025)',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #F8FAFC; color: #334155; overflow: hidden; -webkit-font-smoothing: antialiased; }
        .font-header { font-family: 'Oswald', sans-serif; letter-spacing: 0.025em; }
        
        /* Smooth Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94A3B8; }

        /* Sidebar Navigation */
        .nav-item { transition: all 0.2s ease-in-out; border-radius: 8px; margin: 0 12px; }
        .nav-item:hover { background-color: rgba(255, 255, 255, 0.08); color: #F8FAFC; }
        .nav-item.active { background-color: #F59E0B; color: #FFFFFF; font-weight: 600; box-shadow: 0 4px 6px -1px rgba(245, 158, 11, 0.2); }
        
        /* Input Styles - Modern & Clean */
        input, select, textarea { 
            transition: all 0.2s ease; 
            border: 1px solid #E2E8F0; 
            background-color: #FFFFFF;
            font-size: 0.95rem;
        }
        input:focus, select:focus, textarea:focus { 
            outline: none; 
            border-color: #F59E0B; 
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1); 
        }
        input::placeholder, textarea::placeholder { color: #94A3B8; }
        
        /* Card Styles - Minimalist */
        .card { 
            background-color: #FFFFFF; 
            border: 1px solid #E2E8F0; 
            border-radius: 16px; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            transition: transform 0.2s ease, box-shadow 0.2s ease; 
        }
        .card:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.025); 
        }

        /* --- NEW PREMIUM TABS DESIGN --- */
        .sub-tabs-container {
            background-color: #F1F5F9;
            padding: 4px;
            border-radius: 12px;
            display: flex;
            gap: 4px;
            border: 1px solid #E2E8F0;
        }
        .sub-tab-btn {
            padding: 8px 20px;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #64748B;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid transparent;
        }
        .sub-tab-btn:hover {
            color: #334155;
            background-color: rgba(255,255,255,0.6);
        }
        /* Active State: Thực Hành (Teal theme) */
        .sub-tab-btn.active[data-type="form"] {
            background-color: white;
            color: #0D9488; 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border-color: #E2E8F0;
        }
        /* Active State: Minh Họa (Amber theme) */
        .sub-tab-btn.active[data-type="demo"] {
            background-color: #FFFBEB; 
            color: #B45309; 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border-color: #FCD34D;
        }
        
        /* CWC Tabs */
        .cwc-tab-btn { transition: all 0.2s; border-bottom: 2px solid transparent; }
        .cwc-tab-btn:hover { color: #334155; background-color: #F1F5F9; }
        .cwc-tab-btn.active { background-color: #EFF6FF; color: #2563EB; border-bottom-color: #2563EB; }

        /* Print Styles */
        @media print {
            @page { margin: 1cm; size: A4; }
            body { background-color: white; color: black; overflow: visible; font-size: 11pt; }
            #sidebar, #topbar { display: none !important; }
            #main-content { margin-left: 0 !important; width: 100% !important; height: auto !important; overflow: visible !important; }
            .p-8 { padding: 0 !important; }
            .module-section { display: none !important; }
            .module-section.active { display: block !important; }
            .tab-pane { display: none !important; }
            .tab-pane.active { display: block !important; }
            .card { box-shadow: none !important; border: 1px solid #ddd !important; break-inside: avoid; margin-bottom: 20px; border-radius: 4px; }
            input, textarea, select { border: none !important; background: transparent !important; resize: none; appearance: none; padding: 0 !important; }
            textarea { height: auto !important; min-height: 50px; overflow: visible; }
            /* Hide Tab Navigation in Print */
            .sub-tabs-container, .cwc-tabs-nav { display: none !important; }
            /* Better Print Typography */
            h1, h2, h3, h4 { color: #000 !important; font-weight: bold !important; }
        }
        
        .fade-in { animation: fadeIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="flex h-screen">

    <!-- SIDEBAR -->
    <aside id="sidebar" class="w-72 bg-brand-primary text-slate-400 flex flex-col shrink-0 transition-all duration-300 z-50">
        <div class="h-20 flex items-center px-6 border-b border-white/5 bg-slate-900/50 backdrop-blur-sm">
            <div class="w-10 h-10 bg-gradient-to-br from-brand-accent to-orange-600 rounded-xl flex items-center justify-center text-white font-bold font-header text-2xl shadow-lg shadow-orange-500/20 mr-3 shrink-0">R</div>
            <div>
                <h1 class="text-white font-header text-lg tracking-wide font-medium">ROSIE</h1>
                <p class="text-[10px] uppercase text-brand-teal tracking-widest font-bold opacity-80">Master Toolkit</p>
            </div>
        </div>

        <nav class="flex-1 overflow-y-auto custom-scroll py-6 space-y-2">
            <div class="px-6 pb-2 text-[10px] font-bold uppercase tracking-widest text-slate-500">Tổng Quan</div>
            <a href="#" onclick="showModule('dashboard', this)" class="nav-item active flex items-center gap-3 px-4 py-3 text-sm">
                <i class="fas fa-th-large w-5 opacity-70"></i> Dashboard
            </a>

            <div class="px-6 pb-2 mt-6 text-[10px] font-bold uppercase tracking-widest text-slate-500">Bộ Công Cụ</div>
            <a href="#" onclick="showModule('mod1', this)" class="nav-item flex items-center gap-3 px-4 py-3 text-sm">
                <i class="fas fa-chart-pie w-5 opacity-70"></i> 1. Chiến Lược & Tài Chính
            </a>
            <a href="#" onclick="showModule('mod2', this)" class="nav-item flex items-center gap-3 px-4 py-3 text-sm">
                <i class="fas fa-layer-group w-5 opacity-70"></i> 2. Khung Năng Lực
            </a>
            <a href="#" onclick="showModule('mod3', this)" class="nav-item flex items-center gap-3 px-4 py-3 text-sm">
                <i class="fas fa-microphone-alt w-5 opacity-70"></i> 3. Phỏng Vấn Thực Chiến
            </a>
            <a href="#" onclick="showModule('mod4', this)" class="nav-item flex items-center gap-3 px-4 py-3 text-sm">
                <i class="fas fa-gavel w-5 opacity-70"></i> 4. Ra Quyết Định
            </a>
        </nav>

        <div class="p-4 border-t border-white/5 bg-slate-900/30">
            <button onclick="resetAllData()" class="w-full flex items-center justify-center gap-2 text-xs text-slate-400 hover:text-white hover:bg-white/5 py-2.5 rounded-lg transition font-medium">
                <i class="fas fa-trash-alt"></i> Reset Dữ Liệu
            </button>
            <p class="text-[10px] text-center mt-3 text-slate-600 font-medium">© 2026 Rosie Dao Hanh Giang</p>
        </div>
    </aside>

    <!-- MAIN CONTENT -->
    <div id="main-content" class="flex-1 flex flex-col h-full overflow-hidden bg-[#F8FAFC]">
        
        <!-- Topbar -->
        <header id="topbar" class="h-20 bg-white border-b border-slate-200 flex items-center justify-between px-8 shadow-sm shrink-0 z-40">
            <h2 id="page-title" class="text-2xl font-bold font-header text-slate-800 flex items-center gap-3">
                <span class="bg-brand-accent/10 p-2 rounded-lg text-brand-accent"><i class="fas fa-home"></i></span> Dashboard
            </h2>
            
            <div class="flex items-center gap-3">
                <button onclick="fillExample()" class="text-sm font-semibold text-slate-600 hover:text-brand-blue bg-white hover:bg-slate-50 border border-slate-200 px-4 py-2.5 rounded-lg transition flex items-center gap-2 shadow-sm">
                    <i class="fas fa-magic text-brand-accent"></i> <span class="hidden sm:inline">Điền Mẫu</span>
                </button>
                <div class="h-8 w-px bg-slate-200 mx-1"></div>
                <button onclick="window.print()" class="text-sm font-semibold text-white bg-brand-teal hover:bg-teal-700 px-5 py-2.5 rounded-lg shadow-md shadow-teal-500/20 transition flex items-center gap-2 transform active:scale-95">
                    <i class="fas fa-print"></i> <span class="hidden sm:inline">In PDF</span>
                </button>
                <button onclick="generatePPTX()" class="text-sm font-semibold text-white bg-brand-blue hover:bg-blue-700 px-5 py-2.5 rounded-lg shadow-md shadow-blue-500/20 transition flex items-center gap-2 transform active:scale-95">
                    <i class="fas fa-file-powerpoint"></i> <span class="hidden sm:inline">Tải PPTX</span>
                </button>
            </div>
        </header>

        <!-- Content -->
        <div class="flex-1 overflow-y-auto custom-scroll p-8 lg:p-10">
            
            <!-- DASHBOARD -->
            <div id="dashboard" class="module-section active fade-in">
                <!-- Stats Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
                    <!-- Card 1 -->
                    <div class="card p-6 cursor-pointer group hover:border-brand-red/30" onclick="goToModule('mod1')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="bg-red-50 text-brand-red w-12 h-12 rounded-xl flex items-center justify-center text-xl group-hover:scale-110 transition duration-300"><i class="fas fa-coins"></i></div>
                            <span class="text-[10px] font-bold text-slate-400 group-hover:text-brand-red transition uppercase tracking-wider">Module 1</span>
                        </div>
                        <div class="text-3xl font-header font-bold text-slate-800" id="dash-cost">0 đ</div>
                        <p class="text-sm text-slate-500 font-medium mt-1">Rủi ro tài chính</p>
                    </div>
                    <!-- Card 2 -->
                    <div class="card p-6 cursor-pointer group hover:border-brand-teal/30" onclick="goToModule('mod2')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="bg-teal-50 text-brand-teal w-12 h-12 rounded-xl flex items-center justify-center text-xl group-hover:scale-110 transition duration-300"><i class="fas fa-cubes"></i></div>
                            <span class="text-[10px] font-bold text-slate-400 group-hover:text-brand-teal transition uppercase tracking-wider">Module 2</span>
                        </div>
                        <div class="text-3xl font-header font-bold text-slate-800" id="dash-comp">0</div>
                        <p class="text-sm text-slate-500 font-medium mt-1">Năng lực đã tạo</p>
                    </div>
                    <!-- Card 3 -->
                    <div class="card p-6 cursor-pointer group hover:border-brand-blue/30" onclick="goToModule('mod3')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="bg-blue-50 text-brand-blue w-12 h-12 rounded-xl flex items-center justify-center text-xl group-hover:scale-110 transition duration-300"><i class="fas fa-comments"></i></div>
                            <span class="text-[10px] font-bold text-slate-400 group-hover:text-brand-blue transition uppercase tracking-wider">Module 3</span>
                        </div>
                        <div class="text-3xl font-header font-bold text-slate-800" id="dash-iv">Sẵn sàng</div>
                        <p class="text-sm text-slate-500 font-medium mt-1">Trạng thái phỏng vấn</p>
                    </div>
                    <!-- Card 4 -->
                    <div class="card p-6 cursor-pointer group hover:border-brand-accent/30" onclick="goToModule('mod4')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="bg-amber-50 text-brand-accent w-12 h-12 rounded-xl flex items-center justify-center text-xl group-hover:scale-110 transition duration-300"><i class="fas fa-trophy"></i></div>
                            <span class="text-[10px] font-bold text-slate-400 group-hover:text-brand-accent transition uppercase tracking-wider">Module 4</span>
                        </div>
                        <div class="text-3xl font-header font-bold text-slate-800" id="dash-dec">---</div>
                        <p class="text-sm text-slate-500 font-medium mt-1">Quyết định cuối cùng</p>
                    </div>
                </div>

                <!-- Hero Section -->
                <div class="bg-slate-900 rounded-3xl p-12 text-white relative overflow-hidden shadow-2xl shadow-slate-900/20">
                    <div class="relative z-10 max-w-3xl">
                        <div class="flex items-center gap-3 mb-6">
                            <span class="bg-brand-accent/20 text-brand-accent text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider border border-brand-accent/20">NEW 2026 EDITION</span>
                            <span class="text-slate-400 text-xs font-medium uppercase tracking-wider">v2.5.0</span>
                        </div>
                        <h1 class="text-5xl font-header font-bold mb-6 leading-tight tracking-tight">Hệ Thống Quản Trị Tuyển Dụng <br><span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-accent to-orange-400">ROSIE Master Toolkit</span></h1>
                        <p class="text-slate-300 text-lg mb-10 font-light leading-relaxed max-w-2xl">Bộ công cụ thực chiến toàn diện giúp bạn tối ưu hóa quy trình từ định biên nhân sự đến hội nhập thành công, áp dụng chuẩn CWC (Can Do - Will Do - Culture Fit).</p>
                        <button onclick="goToModule('mod1')" class="bg-brand-accent text-slate-900 px-8 py-4 rounded-xl font-bold hover:bg-amber-400 transition shadow-lg shadow-amber-500/20 inline-flex items-center gap-3 group transform hover:-translate-y-1">
                            Bắt Đầu Ngay <i class="fas fa-arrow-right group-hover:translate-x-1 transition"></i>
                        </button>
                    </div>
                    <!-- Decorative BG -->
                    <div class="absolute -right-20 -bottom-20 opacity-10 transform rotate-12">
                        <i class="fas fa-fingerprint text-[400px] text-white"></i>
                    </div>
                    <div class="absolute top-0 right-0 w-96 h-96 bg-brand-teal/20 rounded-full blur-[100px] -mr-32 -mt-32 pointer-events-none"></div>
                </div>
            </div>

            <!-- MODULE 1: CHIẾN LƯỢC -->
            <div id="mod1" class="module-section hidden fade-in">
                <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
                    <!-- Tool 1: Cost of Bad Hire -->
                    <div class="card overflow-hidden">
                        <div class="px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-white">
                            <h3 class="font-bold text-slate-800 font-header text-xl flex items-center gap-3">
                                <span class="w-8 h-8 rounded-lg bg-red-50 text-brand-red flex items-center justify-center text-sm"><i class="fas fa-calculator"></i></span>
                                Máy Tính Thiệt Hại
                            </h3>
                            <!-- Sub-Tabs -->
                            <div class="sub-tabs-container">
                                <button onclick="switchSubTab(this, 'm1-form')" class="sub-tab-btn active" data-type="form"><i class="fas fa-edit"></i> Thực Hành</button>
                                <button onclick="switchSubTab(this, 'm1-demo')" class="sub-tab-btn" data-type="demo"><i class="fas fa-lightbulb"></i> Minh Họa</button>
                            </div>
                        </div>
                        <div class="p-8">
                            <div id="m1-form" class="tab-pane active space-y-8">
                                <div class="grid grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-xs font-bold text-slate-500 uppercase mb-2 tracking-wide">Mức Lương Tháng (Gross)</label>
                                        <div class="relative group">
                                            <input type="number" id="m1-salary" class="w-full p-4 pl-4 border border-slate-200 rounded-xl text-lg font-bold text-slate-800 save-input bg-slate-50 focus:bg-white transition" placeholder="0" oninput="calcMod1()">
                                            <div class="absolute right-4 top-4 text-slate-400 text-sm font-medium">VNĐ</div>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-bold text-slate-500 uppercase mb-2 tracking-wide">Thời gian lãng phí</label>
                                        <div class="relative group">
                                            <input type="number" id="m1-months" class="w-full p-4 border border-slate-200 rounded-xl text-lg font-bold text-slate-800 save-input bg-slate-50 focus:bg-white transition" value="2" oninput="calcMod1()">
                                            <div class="absolute right-4 top-4 text-slate-400 text-sm font-medium">Tháng</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-red-50/50 p-8 rounded-2xl border border-red-100 text-center relative overflow-hidden">
                                    <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-red-400 to-red-600"></div>
                                    <p class="text-xs text-red-500 font-bold uppercase tracking-widest mb-2">TỔNG THIỆT HẠI ƯỚC TÍNH</p>
                                    <div id="m1-total" class="text-5xl font-header font-bold text-brand-red tracking-tight">0 VNĐ</div>
                                    <p class="text-xs text-slate-400 mt-4 font-medium italic">*Bao gồm: Lương, BHXH, Phí tuyển dụng, Đào tạo & Chi phí cơ hội (x3)</p>
                                </div>
                            </div>
                            <div id="m1-demo" class="tab-pane hidden space-y-6">
                                <div class="bg-amber-50/80 p-8 rounded-2xl border border-amber-100">
                                    <h4 class="font-bold text-amber-800 mb-4 flex items-center gap-2 text-lg"><i class="fas fa-info-circle"></i> Case Study: Tuyển sai Sales Executive</h4>
                                    <ul class="list-none space-y-3 text-sm text-slate-700">
                                        <li class="flex items-center justify-between border-b border-amber-200/50 pb-2"><span>Lương cơ sở:</span> <span class="font-bold font-mono">15.000.000 VNĐ</span></li>
                                        <li class="flex items-center justify-between border-b border-amber-200/50 pb-2"><span>Thời gian làm việc:</span> <span class="font-bold font-mono">2 tháng</span></li>
                                        <li class="flex items-center justify-between border-b border-amber-200/50 pb-2"><span>Chi phí trực tiếp:</span> <span class="font-bold font-mono">~39.000.000 VNĐ</span></li>
                                        <li class="flex items-center justify-between border-b border-amber-200/50 pb-2"><span>Phí tuyển dụng:</span> <span class="font-bold font-mono">~36.000.000 VNĐ</span></li>
                                        <li class="flex items-center justify-between border-b border-amber-200/50 pb-2"><span>Chi phí cơ hội:</span> <span class="font-bold font-mono">~45.000.000 VNĐ</span></li>
                                        <li class="pt-2 mt-4 text-center"><span class="block text-xs font-bold text-amber-600 uppercase mb-1">TỔNG THIỆT HẠI</span> <span class="text-2xl font-bold text-brand-red font-header">~120.000.000 VNĐ</span></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tool 2: EB Audit -->
                    <div class="card overflow-hidden">
                        <div class="px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-white">
                            <h3 class="font-bold text-slate-800 font-header text-xl flex items-center gap-3">
                                <span class="w-8 h-8 rounded-lg bg-teal-50 text-brand-teal flex items-center justify-center text-sm"><i class="fas fa-poll"></i></span>
                                Audit Thương Hiệu (Universum)
                            </h3>
                            <div class="sub-tabs-container">
                                <button onclick="switchSubTab(this, 'm1-aud-form')" class="sub-tab-btn active" data-type="form"><i class="fas fa-edit"></i> Thực Hành</button>
                                <button onclick="switchSubTab(this, 'm1-aud-demo')" class="sub-tab-btn" data-type="demo"><i class="fas fa-lightbulb"></i> Minh Họa</button>
                            </div>
                        </div>
                        <div class="p-8">
                            <div id="m1-aud-form" class="tab-pane active space-y-6">
                                <div class="grid grid-cols-1 gap-5">
                                    <div class="space-y-2">
                                        <div class="flex justify-between"><label class="text-sm font-semibold text-slate-700">1. Lương Thưởng & Phúc Lợi (C&B)</label><span class="text-xs text-slate-400 font-mono">Trụ cột 1</span></div>
                                        <select id="m1-aud1" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg text-sm save-input font-medium" onchange="calcBrand()"><option value="0">Chọn điểm...</option><option value="1">1 - Dưới thị trường</option><option value="3">3 - Cạnh tranh</option><option value="5">5 - Vượt trội</option></select>
                                    </div>
                                    <div class="space-y-2">
                                        <div class="flex justify-between"><label class="text-sm font-semibold text-slate-700">2. Cơ Hội Phát Triển</label><span class="text-xs text-slate-400 font-mono">Trụ cột 2</span></div>
                                        <select id="m1-aud2" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg text-sm save-input font-medium" onchange="calcBrand()"><option value="0">Chọn điểm...</option><option value="1">1 - Không rõ ràng</option><option value="3">3 - Cơ bản</option><option value="5">5 - Lộ trình rõ ràng</option></select>
                                    </div>
                                    <div class="space-y-2">
                                        <div class="flex justify-between"><label class="text-sm font-semibold text-slate-700">3. Văn Hóa & Con Người</label><span class="text-xs text-slate-400 font-mono">Trụ cột 3</span></div>
                                        <select id="m1-aud3" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg text-sm save-input font-medium" onchange="calcBrand()"><option value="0">Chọn điểm...</option><option value="1">1 - Độc hại</option><option value="3">3 - Hòa đồng</option><option value="5">5 - Tôn trọng, minh bạch</option></select>
                                    </div>
                                    <div class="space-y-2">
                                        <div class="flex justify-between"><label class="text-sm font-semibold text-slate-700">4. Trải Nghiệm Ứng Viên</label><span class="text-xs text-slate-400 font-mono">Trụ cột 4</span></div>
                                        <select id="m1-aud4" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg text-sm save-input font-medium" onchange="calcBrand()"><option value="0">Chọn điểm...</option><option value="1">1 - Phản hồi chậm</option><option value="3">3 - Quy trình chuẩn</option><option value="5">5 - Chuyên nghiệp, ấn tượng</option></select>
                                    </div>
                                    <div class="space-y-2">
                                        <div class="flex justify-between"><label class="text-sm font-semibold text-slate-700">5. Danh Tiếng Lãnh Đạo</label><span class="text-xs text-slate-400 font-mono">Trụ cột 5</span></div>
                                        <select id="m1-aud5" class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg text-sm save-input font-medium" onchange="calcBrand()"><option value="0">Chọn điểm...</option><option value="1">1 - Không có thương hiệu</option><option value="3">3 - Được biết đến</option><option value="5">5 - Thought Leader</option></select>
                                    </div>
                                </div>
                                <div class="mt-8 flex items-center justify-between bg-teal-50 p-6 rounded-2xl border border-teal-100">
                                    <div>
                                        <span class="text-xs font-bold text-teal-600 uppercase tracking-widest block mb-1">ĐIỂM SỨC KHỎE EB</span>
                                        <span id="m1-brand-status" class="text-sm font-bold text-teal-800">---</span>
                                    </div>
                                    <span id="m1-brand-score" class="text-5xl font-bold text-brand-teal font-header tracking-tight">0/25</span>
                                </div>
                            </div>
                            <div id="m1-aud-demo" class="tab-pane hidden">
                                <div class="bg-slate-50 p-8 rounded-2xl border border-slate-200">
                                    <h4 class="font-bold text-slate-800 mb-6 text-lg">Case Study: Chuyển đổi Thương hiệu</h4>
                                    <div class="space-y-6">
                                        <div class="flex items-start gap-4">
                                            <div class="w-10 h-10 rounded-full bg-red-100 flex items-center justify-center text-red-600 font-bold shrink-0 shadow-sm">X</div>
                                            <div>
                                                <p class="font-bold text-slate-800 text-base">Trước (10/25 điểm)</p>
                                                <p class="text-sm text-slate-600 mt-1 leading-relaxed">Lương thấp hơn thị trường (2đ), không có lộ trình thăng tiến (1đ), quy trình phỏng vấn kéo dài 4 vòng gây mệt mỏi (2đ).</p>
                                            </div>
                                        </div>
                                        <div class="flex items-start gap-4">
                                            <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-600 font-bold shrink-0 shadow-sm"><i class="fas fa-check"></i></div>
                                            <div>
                                                <p class="font-bold text-slate-800 text-base">Sau (20/25 điểm)</p>
                                                <p class="text-sm text-slate-600 mt-1 leading-relaxed">Điều chỉnh gói phúc lợi linh hoạt (4đ), xây dựng khung năng lực rõ ràng (4đ), cam kết phản hồi trong 48h (5đ). Tỷ lệ nhận offer tăng 40%.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MODULE 2: KHUNG NĂNG LỰC -->
            <div id="mod2" class="module-section hidden fade-in">
                <!-- Competency Dictionary -->
                <div class="card overflow-hidden mb-8">
                    <div class="px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-white">
                        <h3 class="font-bold text-slate-800 font-header text-xl flex items-center gap-3">
                            <span class="w-8 h-8 rounded-lg bg-blue-50 text-brand-blue flex items-center justify-center text-sm"><i class="fas fa-book"></i></span>
                            Từ Điển Năng Lực
                        </h3>
                        <div class="sub-tabs-container">
                            <button onclick="switchSubTab(this, 'm2-dic-form')" class="sub-tab-btn active" data-type="form"><i class="fas fa-edit"></i> Thực Hành</button>
                            <button onclick="switchSubTab(this, 'm2-dic-demo')" class="sub-tab-btn" data-type="demo"><i class="fas fa-lightbulb"></i> Minh Họa</button>
                        </div>
                    </div>
                    
                    <div class="p-8">
                        <div id="m2-dic-form" class="tab-pane active">
                            <div class="mb-8">
                                <label class="block text-xs font-bold text-slate-400 uppercase mb-2 tracking-wide">Tên Năng Lực</label>
                                <input type="text" id="m2-name" class="w-full text-3xl font-bold text-slate-800 border-b-2 border-slate-200 py-2 focus:border-brand-accent bg-transparent placeholder-slate-300 save-input transition font-header" placeholder="VD: Tư Duy Chiến Lược">
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="group h-full flex flex-col">
                                    <div class="flex items-center gap-2 mb-3"><span class="bg-slate-100 text-xs font-bold px-3 py-1 rounded-full text-slate-600 border border-slate-200">LEVEL 1</span><span class="text-sm font-bold text-slate-600">Cơ bản</span></div>
                                    <textarea id="m2-l1" class="w-full flex-1 bg-slate-50 border border-slate-200 rounded-xl p-5 text-sm save-input focus:bg-white focus:shadow-md transition leading-relaxed" placeholder="Mô tả hành vi ở mức thấp nhất: Chỉ làm theo chỉ dẫn, hiểu khái niệm cơ bản..."></textarea>
                                </div>
                                <div class="group h-full flex flex-col">
                                    <div class="flex items-center gap-2 mb-3"><span class="bg-teal-50 text-xs font-bold px-3 py-1 rounded-full text-teal-700 border border-teal-100">LEVEL 3</span><span class="text-sm font-bold text-brand-teal">Thành thạo</span></div>
                                    <textarea id="m2-l3" class="w-full flex-1 bg-teal-50/20 border border-teal-100 rounded-xl p-5 text-sm save-input focus:bg-white focus:border-teal-300 focus:shadow-md transition leading-relaxed" placeholder="Mô tả hành vi mong đợi: Làm việc độc lập, xử lý tình huống phát sinh, đạt hiệu quả cao..."></textarea>
                                </div>
                                <div class="group h-full flex flex-col">
                                    <div class="flex items-center gap-2 mb-3"><span class="bg-amber-50 text-xs font-bold px-3 py-1 rounded-full text-amber-700 border border-amber-100">LEVEL 5</span><span class="text-sm font-bold text-brand-accent">Chuyên gia</span></div>
                                    <textarea id="m2-l5" class="w-full flex-1 bg-amber-50/20 border border-amber-100 rounded-xl p-5 text-sm save-input focus:bg-white focus:border-amber-300 focus:shadow-md transition leading-relaxed" placeholder="Mô tả hành vi xuất sắc: Dẫn dắt người khác, cải tiến quy trình, tạo ra chuẩn mực mới..."></textarea>
                                </div>
                            </div>
                        </div>
                        <div id="m2-dic-demo" class="tab-pane hidden">
                            <h4 class="font-bold text-brand-blue mb-6 text-lg border-b border-slate-100 pb-2">Mẫu: Năng Lực "Giao Tiếp Truyền Cảm Hứng"</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-sm">
                                <div class="p-6 border border-slate-200 rounded-xl bg-slate-50">
                                    <div class="font-bold text-slate-500 mb-3 uppercase text-xs tracking-wider">Level 1 (Cơ bản)</div>
                                    <p class="leading-relaxed text-slate-600">Diễn đạt ý tưởng còn ấp úng, thiếu tự tin. Cần người nghe hỏi lại nhiều lần để làm rõ ý. Thường sử dụng ngôn ngữ tiêu cực hoặc thụ động.</p>
                                </div>
                                <div class="p-6 border border-teal-200 bg-teal-50/50 rounded-xl shadow-sm">
                                    <div class="font-bold text-teal-700 mb-3 uppercase text-xs tracking-wider">Level 3 (Thành thạo)</div>
                                    <p class="leading-relaxed text-slate-700">Trình bày mạch lạc, rõ ràng, cấu trúc logic. Sử dụng ngôn ngữ cơ thể phù hợp. Người nghe hiểu đúng ý ngay lần đầu. Biết cách lắng nghe và phản hồi tích cực.</p>
                                </div>
                                <div class="p-6 border border-amber-200 bg-amber-50/50 rounded-xl shadow-sm">
                                    <div class="font-bold text-amber-700 mb-3 uppercase text-xs tracking-wider">Level 5 (Chuyên gia)</div>
                                    <p class="leading-relaxed text-slate-700">Có khả năng kể chuyện (Storytelling) cuốn hút. Truyền cảm hứng và thay đổi được tư duy/hành vi của người nghe. Điều chỉnh phong cách linh hoạt với mọi đối tượng khán giả.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- CBI Generator -->
                <div class="card overflow-hidden">
                     <div class="px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-white">
                         <h3 class="font-bold text-slate-800 font-header text-xl flex items-center gap-3">
                            <span class="w-8 h-8 rounded-lg bg-purple-50 text-purple-600 flex items-center justify-center text-sm"><i class="fas fa-magic"></i></span>
                            Máy Tạo Câu Hỏi CBI
                        </h3>
                        <div class="sub-tabs-container">
                             <button onclick="switchSubTab(this, 'm2-cbi-form')" class="sub-tab-btn active" data-type="form"><i class="fas fa-edit"></i> Thực Hành</button>
                             <button onclick="switchSubTab(this, 'm2-cbi-demo')" class="sub-tab-btn" data-type="demo"><i class="fas fa-lightbulb"></i> Minh Họa</button>
                        </div>
                    </div>
                    <div class="p-8">
                         <!-- Tab: Form -->
                         <div id="m2-cbi-form" class="tab-pane active">
                            <!-- Formula Visualization -->
                            <div class="mb-8 p-6 bg-slate-50/50 rounded-xl border border-slate-200">
                                <p class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-widest text-center">CÔNG THỨC CÂU HỎI HÀNH VI (STAR FORMULA)</p>
                                <div class="flex items-center justify-center gap-4 text-sm font-medium overflow-x-auto pb-2">
                                    <span class="px-4 py-2 bg-white text-blue-700 rounded-lg border border-blue-200 shadow-sm whitespace-nowrap">1. Kích Hoạt<br><span class="text-xs font-normal text-slate-500">"Hãy kể..."</span></span>
                                    <span class="text-slate-300"><i class="fas fa-plus"></i></span>
                                    <span class="px-4 py-2 bg-white text-amber-700 rounded-lg border border-amber-200 shadow-sm whitespace-nowrap">2. Bối Cảnh<br><span class="text-xs font-normal text-slate-500">"Khi gặp khó..."</span></span>
                                    <span class="text-slate-300"><i class="fas fa-plus"></i></span>
                                    <span class="px-4 py-2 bg-white text-teal-700 rounded-lg border border-teal-200 shadow-sm whitespace-nowrap">3. Hành Động<br><span class="text-xs font-normal text-slate-500">"Bạn làm gì..."</span></span>
                                </div>
                            </div>

                            <div class="flex gap-4 mb-10">
                                <input type="text" id="m2-target" class="flex-1 border-b-2 border-slate-300 py-3 text-2xl text-slate-700 placeholder-slate-300 focus:border-purple-500 bg-transparent save-input transition outline-none font-header" placeholder="Nhập năng lực (VD: Giải quyết vấn đề)...">
                                <button onclick="genQuestions()" class="bg-brand-primary text-white px-8 py-3 rounded-xl font-bold hover:bg-slate-800 transition shadow-lg shadow-slate-800/20 text-sm whitespace-nowrap tracking-wide transform active:scale-95">
                                    TẠO CÂU HỎI
                                </button>
                            </div>

                            <div id="m2-questions" class="grid grid-cols-1 md:grid-cols-2 gap-8 hidden animate-fade-in">
                                <div class="p-8 border border-blue-100 bg-blue-50/20 rounded-2xl relative group hover:bg-blue-50/50 transition">
                                    <div class="absolute -top-3 left-6 bg-brand-blue text-white text-[10px] font-bold px-3 py-1 rounded-full uppercase tracking-wider shadow-md">Hành vi (Behavioral)</div>
                                    <p class="text-lg text-slate-700 font-serif italic leading-relaxed mt-4" id="q-beh">...</p>
                                    <div class="mt-6 pt-4 border-t border-blue-100/50 text-xs text-blue-800 space-y-1 opacity-70">
                                        <p><strong>• Mục tiêu:</strong> Tìm bằng chứng thành công trong quá khứ.</p>
                                    </div>
                                </div>
                                <div class="p-8 border border-red-100 bg-red-50/20 rounded-2xl relative group hover:bg-red-50/50 transition">
                                    <div class="absolute -top-3 left-6 bg-red-500 text-white text-[10px] font-bold px-3 py-1 rounded-full uppercase tracking-wider shadow-md">Nghịch cảnh (Adversity)</div>
                                    <p class="text-lg text-slate-700 font-serif italic leading-relaxed mt-4" id="q-neg">...</p>
                                    <div class="mt-6 pt-4 border-t border-red-100/50 text-xs text-red-800 space-y-1 opacity-70">
                                        <p><strong>• Mục tiêu:</strong> Đánh giá sự trung thực & khả năng học hỏi từ thất bại.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                         <!-- Tab: Demo -->
                         <div id="m2-cbi-demo" class="tab-pane hidden space-y-6">
                            <div class="bg-amber-50/50 p-8 rounded-2xl border border-amber-100">
                                <h4 class="font-bold text-amber-800 mb-6 flex items-center gap-2 text-lg">
                                    <i class="fas fa-lightbulb"></i> Mẫu: Năng lực "Quản Lý Xung Đột"
                                </h4>
                                
                                <div class="space-y-6">
                                    <!-- Mẫu câu hỏi hành vi -->
                                    <div class="p-6 bg-white rounded-xl border border-amber-100 shadow-sm relative overflow-hidden">
                                        <div class="absolute left-0 top-0 bottom-0 w-1 bg-brand-blue"></div>
                                        <div class="text-xs font-bold text-brand-blue uppercase mb-2 tracking-wider ml-2">Hành vi (Behavioral)</div>
                                        <p class="text-slate-700 italic text-lg leading-relaxed ml-2">
                                            "Hãy kể về một lần gần đây nhất <span class="bg-blue-100 text-blue-800 px-1 rounded text-xs mx-1 font-bold">[Kích hoạt]</span> khi hai thành viên trong nhóm bạn có mâu thuẫn gay gắt ảnh hưởng đến tiến độ dự án <span class="bg-amber-100 text-amber-800 px-1 rounded text-xs mx-1 font-bold">[Bối cảnh]</span>. Cụ thể bạn đã làm gì để giải quyết tình huống đó <span class="bg-teal-100 text-teal-800 px-1 rounded text-xs mx-1 font-bold">[Hành động]</span> và kết quả ra sao?"
                                        </p>
                                    </div>
                        
                                    <!-- Mẫu câu hỏi nghịch cảnh -->
                                    <div class="p-6 bg-white rounded-xl border border-amber-100 shadow-sm relative overflow-hidden">
                                        <div class="absolute left-0 top-0 bottom-0 w-1 bg-brand-red"></div>
                                        <div class="text-xs font-bold text-red-500 uppercase mb-2 tracking-wider ml-2">Nghịch cảnh (Adversity)</div>
                                        <p class="text-slate-700 italic text-lg leading-relaxed ml-2">
                                            "Đã bao giờ <span class="bg-blue-100 text-blue-800 px-1 rounded text-xs mx-1 font-bold">[Kích hoạt]</span> bạn cố gắng hòa giải một xung đột nhưng thất bại chưa <span class="bg-red-100 text-red-800 px-1 rounded text-xs mx-1 font-bold">[Bối cảnh tiêu cực]</span>? Tình huống đó diễn ra như thế nào và bạn rút ra bài học gì?"
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MODULE 3 -->
            <div id="mod3" class="module-section hidden fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 h-full">
                    <!-- Left Control Panel -->
                    <div class="lg:col-span-4 space-y-6">
                        <div class="card p-6 border-t-4 border-brand-primary">
                            <div class="flex justify-between items-center mb-6">
                                <span class="text-xs font-bold text-slate-400 uppercase tracking-widest">THỜI GIAN</span>
                                <div id="timer" class="text-2xl font-mono font-bold text-brand-primary bg-slate-100 px-3 py-1 rounded-lg">00:00</div>
                            </div>
                            <input type="text" id="m3-cand" class="w-full text-xl font-bold border-b-2 border-slate-200 pb-2 mb-6 focus:border-brand-accent bg-transparent save-input placeholder-slate-300 transition" placeholder="Tên Ứng Viên...">
                            <button onclick="toggleTimer(this)" class="w-full py-4 rounded-xl bg-brand-primary text-white font-bold text-xs uppercase tracking-widest hover:bg-slate-800 transition flex items-center justify-center gap-3 shadow-lg shadow-slate-900/20 transform active:scale-95">
                                <i class="fas fa-play"></i> Bắt Đầu
                            </button>
                        </div>
                        
                        <div class="bg-blue-50 p-6 rounded-xl border border-blue-100 shadow-sm">
                             <h4 class="font-bold mb-4 uppercase text-[10px] tracking-widest flex items-center gap-2 text-blue-800">
                                <i class="fas fa-search"></i> Kỹ Thuật Đào Sâu 5W3H
                            </h4>
                            <div class="grid grid-cols-2 gap-2">
                                <div class="bg-white p-2.5 rounded-lg border border-blue-100 text-xs cursor-help hover:bg-blue-50 hover:border-blue-300 transition group" title="Cụ thể vấn đề là gì?">
                                    <span class="font-bold text-blue-600 block mb-0.5">WHAT</span>
                                    <span class="text-slate-500 text-[10px]">Vấn đề gì?</span>
                                </div>
                                <div class="bg-white p-2.5 rounded-lg border border-blue-100 text-xs cursor-help hover:bg-blue-50 hover:border-blue-300 transition group" title="Tại sao bạn chọn cách đó?">
                                    <span class="font-bold text-blue-600 block mb-0.5">WHY</span>
                                    <span class="text-slate-500 text-[10px]">Tại sao?</span>
                                </div>
                                <div class="bg-white p-2.5 rounded-lg border border-blue-100 text-xs cursor-help hover:bg-blue-50 hover:border-blue-300 transition group" title="Ai hỗ trợ?">
                                    <span class="font-bold text-blue-600 block mb-0.5">WHO</span>
                                    <span class="text-slate-500 text-[10px]">Ai hỗ trợ?</span>
                                </div>
                                <div class="bg-white p-2.5 rounded-lg border border-blue-100 text-xs cursor-help hover:bg-blue-50 hover:border-blue-300 transition group" title="Khi nào?">
                                    <span class="font-bold text-blue-600 block mb-0.5">WHEN</span>
                                    <span class="text-slate-500 text-[10px]">Khi nào?</span>
                                </div>
                                <div class="bg-white p-2.5 rounded-lg border border-blue-100 text-xs cursor-help hover:bg-blue-50 hover:border-blue-300 transition group" title="Ở đâu?">
                                    <span class="font-bold text-blue-600 block mb-0.5">WHERE</span>
                                    <span class="text-slate-500 text-[10px]">Ở đâu?</span>
                                </div>
                                <div class="bg-white p-2.5 rounded-lg border border-blue-100 text-xs cursor-help hover:bg-blue-50 hover:border-blue-300 transition group" title="Làm thế nào?">
                                    <span class="font-bold text-blue-600 block mb-0.5">HOW</span>
                                    <span class="text-slate-500 text-[10px]">Làm sao?</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Note Panel -->
                    <div class="lg:col-span-8 card flex flex-col h-[650px] overflow-hidden">
                         <div class="px-6 py-4 border-b border-slate-100 flex items-center justify-between bg-white shrink-0">
                             <h3 class="font-bold text-slate-800 font-header text-lg flex items-center gap-2">
                                <span class="w-8 h-8 rounded-lg bg-blue-50 text-brand-blue flex items-center justify-center text-sm"><i class="fas fa-microphone-alt"></i></span>
                                Phỏng Vấn (CWC Model)
                            </h3>
                            <div class="flex bg-slate-100 p-1 rounded-lg gap-1">
                                <button onclick="switchCWCTab('cwc-can')" class="cwc-tab-btn active px-4 py-1.5 text-xs font-bold rounded-md transition border-none shadow-sm">CAN DO</button>
                                <button onclick="switchCWCTab('cwc-will')" class="cwc-tab-btn px-4 py-1.5 text-xs font-bold rounded-md transition border-none">WILL DO</button>
                                <button onclick="switchCWCTab('cwc-fit')" class="cwc-tab-btn px-4 py-1.5 text-xs font-bold rounded-md transition border-none">CULTURE FIT</button>
                                <button onclick="switchCWCTab('cwc-lead')" class="cwc-tab-btn px-4 py-1.5 text-xs font-bold rounded-md transition border-none text-purple-600 hover:bg-purple-50"><i class="fas fa-crown mr-1"></i> LEADER</button>
                            </div>
                        </div>
                        
                        <div class="p-8 flex-1 overflow-y-auto custom-scroll bg-slate-50/50">
                            <!-- CAN DO TAB -->
                            <div id="cwc-can" class="cwc-pane active space-y-6">
                                <div class="flex items-center gap-3 p-4 bg-blue-50 border border-blue-100 rounded-xl text-xs text-blue-800 mb-2 shadow-sm">
                                    <i class="fas fa-info-circle text-lg"></i>
                                    <strong>Mục tiêu:</strong> Đánh giá Kiến thức chuyên môn, Kỹ năng thực hành, Kinh nghiệm thực tế.
                                </div>
                                <div class="space-y-5">
                                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                                        <label class="text-xs font-bold text-slate-400 uppercase tracking-wider block mb-2">S.T (Bối cảnh/Thách thức)</label>
                                        <textarea class="w-full bg-transparent resize-none h-16 outline-none text-sm text-slate-700 placeholder-slate-300 save-input" placeholder="Dự án gì? Quy mô? Khó khăn kỹ thuật?"></textarea>
                                    </div>
                                    <div class="bg-white p-5 rounded-xl border-2 border-brand-blue/30 shadow-md">
                                        <label class="text-xs font-bold text-brand-blue uppercase tracking-wider block mb-2 flex justify-between">ACTION (Hành động cụ thể) <span class="bg-brand-blue text-white px-2 py-0.5 rounded text-[10px]">QUAN TRỌNG</span></label>
                                        <textarea class="w-full bg-transparent resize-none h-32 outline-none text-base text-slate-800 placeholder-slate-300 save-input font-medium leading-relaxed" placeholder="Họ đã dùng công cụ gì? Các bước thực hiện chi tiết? (Chú ý ngôi 'Tôi')"></textarea>
                                    </div>
                                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                                        <label class="text-xs font-bold text-slate-400 uppercase tracking-wider block mb-2">RESULT (Kết quả)</label>
                                        <textarea class="w-full bg-transparent resize-none h-16 outline-none text-sm text-slate-700 placeholder-slate-300 save-input" placeholder="Con số định lượng? Bài học rút ra?"></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- WILL DO TAB -->
                            <div id="cwc-will" class="cwc-pane hidden space-y-6">
                                <div class="p-4 bg-amber-50 border border-amber-100 rounded-xl text-xs text-amber-800 mb-2 shadow-sm flex items-center gap-3">
                                    <i class="fas fa-fire text-lg"></i>
                                    <strong>Mục tiêu:</strong> Đánh giá Động lực, Thái độ, Sự bền bỉ (Resilience).
                                </div>
                                <div class="space-y-5">
                                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                                        <label class="text-xs font-bold text-slate-400 uppercase tracking-wider block mb-2">Động lực làm việc</label>
                                        <textarea class="w-full bg-transparent resize-none h-24 outline-none text-sm text-slate-700 placeholder-slate-300 save-input" placeholder="Tại sao họ muốn công việc này? Điều gì thúc đẩy họ mỗi sáng?"></textarea>
                                    </div>
                                    <div class="bg-white p-5 rounded-xl border-2 border-brand-accent/30 shadow-md">
                                        <label class="text-xs font-bold text-brand-accent uppercase tracking-wider block mb-2">Phản ứng với khó khăn (Resilience)</label>
                                        <textarea class="w-full bg-transparent resize-none h-32 outline-none text-base text-slate-800 placeholder-slate-300 save-input font-medium" placeholder="Thái độ khi gặp thất bại? Có đổ lỗi cho hoàn cảnh không?"></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- CULTURE FIT TAB -->
                            <div id="cwc-fit" class="cwc-pane hidden space-y-6">
                                <div class="p-4 bg-teal-50 border border-teal-100 rounded-xl text-xs text-teal-800 mb-2 shadow-sm flex items-center gap-3">
                                    <i class="fas fa-heart text-lg"></i>
                                    <strong>Mục tiêu:</strong> Đánh giá Giá trị cốt lõi, Tương thích đội nhóm.
                                </div>
                                <div class="space-y-5">
                                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                                        <label class="text-xs font-bold text-slate-400 uppercase tracking-wider block mb-2">Giá trị cốt lõi (Core Values)</label>
                                        <textarea class="w-full bg-transparent resize-none h-24 outline-none text-sm text-slate-700 placeholder-slate-300 save-input" placeholder="Họ có chia sẻ giá trị giống công ty không?"></textarea>
                                    </div>
                                    <div class="bg-white p-5 rounded-xl border-2 border-brand-teal/30 shadow-md">
                                        <label class="text-xs font-bold text-brand-teal uppercase tracking-wider block mb-2">Làm việc nhóm (Teamwork)</label>
                                        <textarea class="w-full bg-transparent resize-none h-32 outline-none text-base text-slate-800 placeholder-slate-300 save-input font-medium" placeholder="Cách họ nói về đồng nghiệp cũ? Có cái tôi quá lớn không?"></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- LEADERSHIP TAB -->
                            <div id="cwc-lead" class="cwc-pane hidden space-y-6">
                                <div class="p-4 bg-purple-50 border border-purple-100 rounded-xl text-xs text-purple-800 mb-2 shadow-sm flex items-center gap-3">
                                    <i class="fas fa-crown text-lg"></i>
                                    <strong>Mục tiêu:</strong> Đánh giá Tư duy chiến lược & Quản lý con người (Dành cho Manager).
                                </div>
                                <div class="space-y-5">
                                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                                        <label class="text-xs font-bold text-slate-400 uppercase tracking-wider block mb-2">Phong cách lãnh đạo</label>
                                        <textarea class="w-full bg-transparent resize-none h-20 outline-none text-sm text-slate-700 placeholder-slate-300 save-input" placeholder="Cách họ giao việc (Delegation)? Cách họ phản hồi (Feedback)?"></textarea>
                                    </div>
                                    <div class="bg-white p-5 rounded-xl border-2 border-purple-200 shadow-md">
                                        <label class="text-xs font-bold text-purple-600 uppercase tracking-wider block mb-2">Phát triển nhân tài (People Development)</label>
                                        <textarea class="w-full bg-transparent resize-none h-24 outline-none text-base text-slate-800 placeholder-slate-300 save-input font-medium" placeholder="Họ đã đào tạo ai thành công chưa? Ví dụ cụ thể?"></textarea>
                                    </div>
                                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                                        <label class="text-xs font-bold text-slate-400 uppercase tracking-wider block mb-2">Quản lý thay đổi (Change Mgmt)</label>
                                        <textarea class="w-full bg-transparent resize-none h-20 outline-none text-sm text-slate-700 placeholder-slate-300 save-input" placeholder="Cách họ dẫn dắt team qua giai đoạn khó khăn?"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MODULE 4 -->
            <div id="mod4" class="module-section hidden fade-in">
                 <div class="card overflow-hidden mb-8">
                     <div class="px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-white">
                         <h3 class="font-bold text-slate-800 font-header text-xl flex items-center gap-3">
                            <span class="w-8 h-8 rounded-lg bg-yellow-50 text-brand-accent flex items-center justify-center text-sm"><i class="fas fa-balance-scale"></i></span>
                            Bảng Điểm CWC (Decision Scorecard)
                        </h3>
                        <div class="sub-tabs-container">
                            <button onclick="switchSubTab(this, 'm4-matrix-form')" class="sub-tab-btn active" data-type="form"><i class="fas fa-edit"></i> Đánh Giá</button>
                            <button onclick="switchSubTab(this, 'm4-matrix-demo')" class="sub-tab-btn" data-type="demo"><i class="fas fa-lightbulb"></i> Minh Họa</button>
                        </div>
                    </div>
                    
                    <div class="p-0">
                        <div id="m4-matrix-form" class="tab-pane active">
                            <table class="w-full text-sm text-left">
                                <thead class="bg-slate-50 text-slate-500 font-bold text-xs uppercase border-b border-slate-200 tracking-wider">
                                    <tr>
                                        <th class="p-6 pl-8 w-1/3">Tiêu Chí (CWC Model)</th>
                                        <th class="p-6 w-24 text-center">Trọng Số</th>
                                        <th class="p-6 w-32 text-center bg-blue-50/50 text-blue-600 border-b-2 border-blue-500">Ứng Viên A</th>
                                        <th class="p-6 w-32 text-center text-slate-600 border-b-2 border-slate-300">Ứng Viên B</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-slate-100">
                                    <!-- CAN DO -->
                                    <tr class="bg-slate-50/30"><td colspan="4" class="px-8 py-3 text-xs font-bold text-blue-600 uppercase tracking-widest bg-blue-50/20">I. CAN DO (Năng Lực) - 40%</td></tr>
                                    <tr class="hover:bg-slate-50"><td class="p-4 pl-12 font-medium text-slate-700">1. Kỹ năng chuyên môn</td><td class="p-4 text-center text-slate-400">20%</td><td class="p-4 text-center bg-blue-50/10"><input type="number" min="1" max="5" class="w-12 text-center border border-slate-200 rounded p-1 font-bold text-slate-700 save-input m4-a focus:bg-white" oninput="calcMatrix()"></td><td class="p-4 text-center"><input type="number" min="1" max="5" class="w-12 text-center border border-slate-200 rounded p-1 font-bold text-slate-700 save-input m4-b focus:bg-white" oninput="calcMatrix()"></td></tr>
                                    <tr class="hover:bg-slate-50"><td class="p-4 pl-12 font-medium text-slate-700">2. Kinh nghiệm thực chiến</td><td class="p-4 text-center text-slate-400">20%</td><td class="p-4 text-center bg-blue-50/10"><input type="number" min="1" max="5" class="w-12 text-center border border-slate-200 rounded p-1 font-bold text-slate-700 save-input m4-a focus:bg-white" oninput="calcMatrix()"></td><td class="p-4 text-center"><input type="number" min="1" max="5" class="w-12 text-center border border-slate-200 rounded p-1 font-bold text-slate-700 save-input m4-b focus:bg-white" oninput="calcMatrix()"></td></tr>
                                    
                                    <!-- WILL DO -->
                                    <tr class="bg-slate-50/30"><td colspan="4" class="px-8 py-3 text-xs font-bold text-amber-600 uppercase tracking-widest bg-amber-50/20">II. WILL DO (Động Lực) - 30%</td></tr>
                                    <tr class="hover:bg-slate-50"><td class="p-4 pl-12 font-medium text-slate-700">3. Động lực & Thái độ</td><td class="p-4 text-center text-slate-400">30%</td><td class="p-4 text-center bg-blue-50/10"><input type="number" min="1" max="5" class="w-12 text-center border border-slate-200 rounded p-1 font-bold text-slate-700 save-input m4-a focus:bg-white" oninput="calcMatrix()"></td><td class="p-4 text-center"><input type="number" min="1" max="5" class="w-12 text-center border border-slate-200 rounded p-1 font-bold text-slate-700 save-input m4-b focus:bg-white" oninput="calcMatrix()"></td></tr>

                                    <!-- CULTURE FIT -->
                                    <tr class="bg-slate-50/30"><td colspan="4" class="px-8 py-3 text-xs font-bold text-teal-600 uppercase tracking-widest bg-teal-50/20">III. CULTURE FIT (Văn Hóa) - 30%</td></tr>
                                    <tr class="hover:bg-slate-50"><td class="p-4 pl-12 font-medium text-slate-700">4. Phù hợp văn hóa</td><td class="p-4 text-center text-slate-400">30%</td><td class="p-4 text-center bg-blue-50/10"><input type="number" min="1" max="5" class="w-12 text-center border border-slate-200 rounded p-1 font-bold text-slate-700 save-input m4-a focus:bg-white" oninput="calcMatrix()"></td><td class="p-4 text-center"><input type="number" min="1" max="5" class="w-12 text-center border border-slate-200 rounded p-1 font-bold text-slate-700 save-input m4-b focus:bg-white" oninput="calcMatrix()"></td></tr>

                                    <!-- LEADERSHIP (OPTIONAL) -->
                                    <tr class="bg-slate-50/30"><td colspan="4" class="px-8 py-3 text-xs font-bold text-purple-600 uppercase tracking-widest bg-purple-50/20">IV. LEADERSHIP (Dành cho Manager) - 30%</td></tr>
                                    <tr class="hover:bg-slate-50"><td class="p-4 pl-12 font-medium text-slate-700">5. Năng lực quản lý</td><td class="p-4 text-center text-slate-400">30%</td><td class="p-4 text-center bg-blue-50/10"><input type="number" min="1" max="5" class="w-12 text-center border border-slate-200 rounded p-1 font-bold text-slate-700 save-input m4-a focus:bg-white" oninput="calcMatrix()"></td><td class="p-4 text-center"><input type="number" min="1" max="5" class="w-12 text-center border border-slate-200 rounded p-1 font-bold text-slate-700 save-input m4-b focus:bg-white" oninput="calcMatrix()"></td></tr>

                                    <tr class="bg-slate-900 text-white text-lg"><td class="p-6 pl-8 text-right font-header font-bold" colspan="2">TỔNG ĐIỂM (WEIGHTED):</td><td class="p-6 text-center text-brand-accent font-bold text-xl" id="m4-total-a">0.0</td><td class="p-6 text-center text-slate-300 font-bold text-xl" id="m4-total-b">0.0</td></tr>
                                </tbody>
                            </table>
                             <div id="m4-verdict" class="text-center hidden p-8"><span class="bg-gradient-to-r from-brand-primary to-slate-800 text-white px-8 py-3 rounded-full font-bold text-lg shadow-xl tracking-wide uppercase border border-white/20 transform hover:scale-105 transition">🏆 Quyết Định: <span id="winner" class="text-brand-accent"></span></span></div>
                        </div>
                        
                        <div id="m4-matrix-demo" class="tab-pane hidden p-8">
                            <div class="bg-green-50/50 border border-green-200 p-8 rounded-2xl">
                                <h4 class="font-bold text-green-800 mb-4 text-lg">Phân Tích CWC: Vị trí Trưởng phòng Marketing</h4>
                                <div class="space-y-4 text-sm text-slate-700">
                                    <div class="p-4 bg-white rounded-lg border border-green-100 shadow-sm">
                                        <div class="flex justify-between mb-2"><strong class="text-slate-800">Ứng viên A (Giỏi chuyên môn)</strong> <span class="bg-slate-100 px-2 py-0.5 rounded text-xs font-bold">Tổng: 3.7</span></div>
                                        <p>Can Do rất tốt (5/5) nhưng Culture Fit thấp (2/5). Có dấu hiệu "Ngôi sao cô đơn", khó hợp tác.</p>
                                    </div>
                                    <div class="p-4 bg-white rounded-lg border border-green-100 shadow-sm border-l-4 border-l-green-500">
                                        <div class="flex justify-between mb-2"><strong class="text-slate-800">Ứng viên B (Phù hợp văn hóa)</strong> <span class="bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs font-bold">Tổng: 4.3</span></div>
                                        <p>Can Do khá (4/5), nhưng Will Do và Culture Fit xuất sắc (5/5). Có tố chất lãnh đạo và tư duy phát triển con người.</p>
                                    </div>
                                </div>
                                <div class="mt-6 pt-6 border-t border-green-200/50">
                                    <p class="font-bold text-green-700 flex items-center gap-2"><i class="fas fa-check-circle"></i> Kết luận: Chọn Ứng viên B.</p>
                                    <p class="text-xs text-green-600 mt-1 italic">Lý do: Kỹ năng có thể đào tạo thêm, nhưng sự phù hợp văn hóa và động lực là yếu tố then chốt cho vị trí quản lý dài hạn.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- LOGIC SCRIPT -->
    <script>
        // --- CWC TABS LOGIC ---
        function switchCWCTab(tabId) {
            document.querySelectorAll('.cwc-tab-btn').forEach(b => {
                b.classList.remove('bg-white', 'text-brand-blue', 'shadow-sm');
                b.classList.add('text-slate-500', 'hover:bg-white/50');
            });
            event.target.classList.remove('text-slate-500', 'hover:bg-white/50');
            event.target.classList.add('bg-white', 'text-brand-blue', 'shadow-sm');
            document.querySelectorAll('.cwc-pane').forEach(p => p.classList.add('hidden'));
            document.getElementById(tabId).classList.remove('hidden');
        }

        // --- SUB TABS LOGIC ---
        function switchSubTab(btn, targetId) {
            const parent = btn.closest('.sub-tabs-container');
            parent.querySelectorAll('.sub-tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            const wrapper = btn.closest('.card, .bg-white');
            const panes = wrapper.querySelectorAll('.tab-pane');
            panes.forEach(p => { p.classList.add('hidden'); p.classList.remove('active'); });
            const target = document.getElementById(targetId);
            if(target) { target.classList.remove('hidden'); target.classList.add('active'); }
        }

        // --- NAVIGATION ---
        function showModule(id, el) {
            const sections = document.querySelectorAll('.module-section');
            sections.forEach(div => { div.style.opacity = '0'; setTimeout(() => { div.classList.add('hidden'); div.classList.remove('active'); }, 200); });
            setTimeout(() => { const target = document.getElementById(id); target.classList.remove('hidden'); target.classList.add('active'); void target.offsetWidth; target.style.opacity = '1'; }, 200);
            if(el) { document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active', 'border-l-4', 'border-brand-accent', 'bg-white/5', 'text-white', 'font-semibold')); el.classList.add('active', 'border-l-4', 'border-brand-accent', 'bg-white/5', 'text-white', 'font-semibold'); }
            const titles = { 'dashboard': 'Dashboard', 'mod1': 'Chiến Lược', 'mod2': 'Khung Năng Lực', 'mod3': 'Phỏng Vấn', 'mod4': 'Ra Quyết Định' };
            document.getElementById('page-title').innerHTML = `<span class="bg-brand-accent/10 p-1.5 rounded text-brand-accent mr-2"><i class="fas fa-layer-group"></i></span> ${titles[id]}`;
        }
        function goToModule(id) { document.querySelector(`a[onclick*='${id}']`).click(); }

        // --- CALCULATIONS ---
        function calcMod1() {
            const s = parseFloat(document.getElementById('m1-salary').value) || 0;
            const m = parseFloat(document.getElementById('m1-months').value) || 0;
            const total = (s * m * 1.3) + (s * 3) + (s * 2 * 0.2 * m);
            document.getElementById('m1-total').innerText = total.toLocaleString() + ' VNĐ';
            document.getElementById('dash-cost').innerText = (total/1000000).toFixed(0) + ' Tr';
            saveData();
        }
        function calcBrand() {
            let score = 0; for(let i=1; i<=5; i++) score += parseInt(document.getElementById('m1-aud'+i).value);
            document.getElementById('m1-brand-score').innerText = score + '/25';
            let status = score < 10 ? "Cần Cải Thiện" : (score < 18 ? "Khá" : "Xuất Sắc");
            document.getElementById('m1-brand-status').innerText = status;
            saveData();
        }
        function genQuestions() {
            const comp = document.getElementById('m2-target').value;
            if(!comp) return alert("Vui lòng nhập tên năng lực!");
            document.getElementById('m2-questions').classList.remove('hidden');
            document.getElementById('q-beh').innerHTML = `“Hãy kể cho tôi nghe về một tình huống gần đây nhất <span class='text-slate-400 text-sm'>[Kích hoạt]</span> mà bạn phải sử dụng kỹ năng <strong class="text-brand-blue">${comp}</strong> để giải quyết một vấn đề phức tạp <span class='text-slate-400 text-sm'>[Bối cảnh]</span>. Cụ thể bạn đã làm gì <span class='text-slate-400 text-sm'>[Hành động]</span> và kết quả ra sao?”`;
            document.getElementById('q-neg').innerHTML = `“Đã bao giờ bạn cảm thấy thất bại hoặc chưa hài lòng <span class='text-slate-400 text-sm'>[Bối cảnh]</span> trong việc <strong class="text-red-500">${comp}</strong> chưa? Tình huống đó là gì và bạn rút ra bài học gì cho lần sau?”`;
            document.getElementById('dash-comp').innerText = "Active";
        }
        let timerInt;
        function toggleTimer(btn) {
            if(timerInt) { clearInterval(timerInt); timerInt = null; btn.innerHTML = '<i class="fas fa-play"></i> Tiếp Tục'; btn.classList.remove('bg-red-600', 'hover:bg-red-700'); btn.classList.add('bg-brand-primary', 'hover:bg-slate-800'); document.getElementById('dash-iv').innerText = "Tạm dừng"; } 
            else { let current = document.getElementById('timer').innerText; let [m, s] = current.split(':').map(Number); let sec = m * 60 + s; btn.innerHTML = '<i class="fas fa-pause"></i> Dừng'; btn.classList.remove('bg-brand-primary', 'hover:bg-slate-800'); btn.classList.add('bg-red-600', 'hover:bg-red-700'); document.getElementById('dash-iv').innerText = "Đang PV"; timerInt = setInterval(() => { sec++; const d = new Date(0); d.setSeconds(sec); document.getElementById('timer').innerText = d.toISOString().substr(14, 5); }, 1000); }
        }
        function calcMatrix() {
            const w = [0.15, 0.15, 0.2, 0.2, 0.3]; 
            let a = 0, b = 0;
            const inA = document.querySelectorAll('.m4-a');
            const inB = document.querySelectorAll('.m4-b');
            inA.forEach((el, i) => a += (parseFloat(el.value)||0) * w[i]);
            inB.forEach((el, i) => b += (parseFloat(el.value)||0) * w[i]);
            document.getElementById('m4-total-a').innerText = a.toFixed(1);
            document.getElementById('m4-total-b').innerText = b.toFixed(1);
            const verdict = document.getElementById('m4-verdict');
            if(a > 0 || b > 0) { verdict.classList.remove('hidden'); if(a > b) document.getElementById('winner').innerText = "ỨNG VIÊN A"; else if(b > a) document.getElementById('winner').innerText = "ỨNG VIÊN B"; else document.getElementById('winner').innerText = "CÂN NHẮC"; }
            saveData();
        }

        // --- PPTX ---
        function generatePPTX() {
            let pres = new PptxGenJS(); pres.layout = 'LAYOUT_16x9';
            const C_DARK="0F172A", C_BLUE="3B82F6", C_ORANGE="F59E0B";
            function addSlideTitle(slide, title) { slide.background = { color: "FFFFFF" }; slide.addShape(pres.ShapeType.rect, { x: 0, y: 0, w: 10, h: 0.8, fill: { color: C_DARK } }); slide.addText("ROSIE 2026", { x: 0.2, y: 0.2, fontSize: 14, color: "FFFFFF", bold: true }); slide.addText(title, { x: 0.5, y: 1.2, w: 9, fontSize: 24, bold: true, color: C_BLUE, fontFace: "Arial" }); }
            const activeMod = document.querySelector('.module-section.active').id;
            if(activeMod === 'mod1') {
                let slide = pres.addSlide(); addSlideTitle(slide, "BÁO CÁO CHIẾN LƯỢC & TÀI CHÍNH");
                let loss = document.getElementById('m1-total').innerText;
                slide.addText("Tổng Thiệt Hại Ước Tính:", { x: 1, y: 2.5, fontSize: 18, color: "666666" });
                slide.addText(loss, { x: 1, y: 3, fontSize: 32, color: "EF4444", bold: true });
            } else if (activeMod === 'mod2') {
                let slide = pres.addSlide(); addSlideTitle(slide, "TỪ ĐIỂN NĂNG LỰC");
                let name = document.getElementById('m2-name').value || "Chưa đặt tên";
                slide.addText(name, { x: 1, y: 2.5, fontSize: 24, color: C_BLUE, bold: true });
            } else if (activeMod === 'mod3') {
                let slide = pres.addSlide(); addSlideTitle(slide, "BIÊN BẢN PHỎNG VẤN (CWC MODEL)");
                let cand = document.getElementById('m3-cand').value || "Ứng viên";
                slide.addText("Ứng viên: " + cand, { x: 1, y: 2.5, fontSize: 20, bold: true });
            } else if (activeMod === 'mod4') {
                let slide = pres.addSlide(); addSlideTitle(slide, "QUYẾT ĐỊNH TUYỂN DỤNG (CWC SCORECARD)");
                let w = document.getElementById('winner').innerText;
                slide.addText(`KẾT QUẢ: ${w}`, { x: 0.5, y: 2.5, fontSize: 32, bold: true, color: "10B981" });
            } else { alert("Vui lòng vào một Module cụ thể để tải báo cáo."); return; }
            pres.writeFile({ fileName: `ROSIE_Report_2026.pptx` });
        }

        // --- CORE ---
        function saveData() { const data = {}; document.querySelectorAll('.save-input').forEach((el, i) => { data['inp_'+i] = (el.type === 'checkbox') ? el.checked : el.value; }); localStorage.setItem('rosie_2026', JSON.stringify(data)); }
        function loadData() { const data = JSON.parse(localStorage.getItem('rosie_2026')); if(!data) return; document.querySelectorAll('.save-input').forEach((el, i) => { if(data['inp_'+i] !== undefined) { if(el.type === 'checkbox') el.checked = data['inp_'+i]; else el.value = data['inp_'+i]; } }); calcMod1(); calcBrand(); calcMatrix(); }
        function resetAllData() { if(confirm("Xóa dữ liệu?")) { localStorage.removeItem('rosie_2026'); location.reload(); } }
        function fillExample() {
            const currentMod = document.querySelector('.module-section.active').id;
            if(currentMod === 'mod4') {
                const m4a = document.querySelectorAll('.m4-a'); const m4b = document.querySelectorAll('.m4-b');
                m4a[0].value = 5; m4a[1].value = 4; m4a[2].value = 4; m4a[3].value = 3; m4a[4].value = 2; 
                m4b[0].value = 4; m4b[1].value = 4; m4b[2].value = 5; m4b[3].value = 5; m4b[4].value = 5; 
                calcMatrix();
            }
            alert("Đã điền dữ liệu mẫu!");
        }
        window.onload = loadData;
    </script>
</body>
</html>